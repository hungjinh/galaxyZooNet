Namespace(config='configs/resnet50_run0.yaml')

------ Parameters ------

exp_name : run0
cuda : True
ngpu : 1
gpu_device : 0
workers : 1
dir_image : /home/hhg/Research/galaxyClassify/catalog/galaxyZoo_kaggle/gz2_images/images
file_csv : /home/hhg/Research/galaxyClassify/catalog/galaxyZoo/zoo2/classAll_4label_temp.csv
label_tag : label1
num_classes : 8
f_train : 0.64
f_valid : 0.16
f_test : 0.2
seed : 3
norm_mean : [0.485, 0.456, 0.406]
norm_std : [0.229, 0.224, 0.225]
input_size : 224
pretrained : True
num_epochs : 50
batch_size : 64
lr : 5e-05
step_size : 5
gamma : 0.1
early_stop_threshold : 10
dir_output : /home/hhg/Research/galaxyClassify/repo/galaxyZooNet/experiment/resnet50

------ Prepare Data ------

Number of train galaxies: 99808 (1560 batches)
Number of valid galaxies: 24952 (390 batches)
Number of test galaxies: 31191 (488 batches)

------ Build Model ------

Number of trainable parameters
layer1 : 215808
layer2 : 1219584
layer3 : 14964736
layer4 : 7098368
fc     : 16392
TOTAL  : 23524424

------ Create experiment directory ------

Training information will be stored at :
 	 /home/hhg/Research/galaxyClassify/repo/galaxyZooNet/experiment/resnet50/run0

------ Training ------

Epoch 1/50
	train Loss: 0.6919 Acc: 0.7476 	valid Loss: 0.5623 Acc: 0.7926 	Time: 10m 3s
Epoch 2/50
	train Loss: 0.5588 Acc: 0.7952 	valid Loss: 0.5248 Acc: 0.8069 	Time: 10m 2s
Epoch 3/50
	train Loss: 0.5277 Acc: 0.8053 	valid Loss: 0.5100 Acc: 0.8096 	Time: 10m 4s
Epoch 4/50
	train Loss: 0.5055 Acc: 0.8134 	valid Loss: 0.5108 Acc: 0.8088 	Time: 10m 5s
Epoch 5/50
	train Loss: 0.4881 Acc: 0.8201 	valid Loss: 0.5196 Acc: 0.8118 	Time: 10m 4s
Epoch 6/50
	train Loss: 0.4313 Acc: 0.8402 	valid Loss: 0.4365 Acc: 0.8391 	Time: 10m 5s
Epoch 7/50
	train Loss: 0.4198 Acc: 0.8446 	valid Loss: 0.4295 Acc: 0.8407 	Time: 10m 3s
Epoch 8/50
	train Loss: 0.4117 Acc: 0.8466 	valid Loss: 0.4324 Acc: 0.8374 	Time: 10m 3s
Epoch 9/50
	train Loss: 0.4087 Acc: 0.8480 	valid Loss: 0.4316 Acc: 0.8406 	Time: 10m 4s
Epoch 10/50
	train Loss: 0.4040 Acc: 0.8490 	valid Loss: 0.4259 Acc: 0.8425 	Time: 10m 3s
Epoch 11/50
	train Loss: 0.3945 Acc: 0.8529 	valid Loss: 0.4193 Acc: 0.8468 	Time: 10m 3s
Epoch 12/50
	train Loss: 0.3943 Acc: 0.8527 	valid Loss: 0.4186 Acc: 0.8436 	Time: 10m 2s
Epoch 13/50
	train Loss: 0.3915 Acc: 0.8539 	valid Loss: 0.4229 Acc: 0.8423 	Time: 10m 9s
Epoch 14/50
	train Loss: 0.3927 Acc: 0.8529 	valid Loss: 0.4237 Acc: 0.8437 	Time: 10m 2s
Epoch 15/50
	train Loss: 0.3919 Acc: 0.8539 	valid Loss: 0.4217 Acc: 0.8439 	Time: 10m 8s
Epoch 16/50
	train Loss: 0.3910 Acc: 0.8536 	valid Loss: 0.4215 Acc: 0.8439 	Time: 10m 5s
Epoch 17/50
	train Loss: 0.3914 Acc: 0.8539 	valid Loss: 0.4183 Acc: 0.8462 	Time: 10m 6s
Epoch 18/50
	train Loss: 0.3915 Acc: 0.8531 	valid Loss: 0.4190 Acc: 0.8435 	Time: 10m 5s
Epoch 19/50
	train Loss: 0.3910 Acc: 0.8540 	valid Loss: 0.4227 Acc: 0.8420 	Time: 10m 2s
Epoch 20/50
	train Loss: 0.3920 Acc: 0.8532 	valid Loss: 0.4241 Acc: 0.8430 	Time: 10m 3s
Epoch 21/50
	train Loss: 0.3932 Acc: 0.8532 	valid Loss: 0.4188 Acc: 0.8450 	Time: 10m 3s
Early stopping... (Model did not imporve after 10 epochs)
Best accuracy of 0.846825905739019 reached at epoch 10.

------ Run test on the full test dataset (8 galaxy classes) ------

  Number of galaxies: 31191 (488 batches)
  	test Loss: 0.4110	 test Accuracy: 0.8494

------ Run test on each galaxy morphology class separately ------

Class 0 galaxies
  Number of galaxies: 6755 (106 batches)
	test Loss: 0.2330	 test Accuracy: 0.9224
Class 1 galaxies
  Number of galaxies: 7845 (123 batches)
	test Loss: 0.3406	 test Accuracy: 0.8748
Class 2 galaxies
  Number of galaxies: 1471 (23 batches)
	test Loss: 0.6286	 test Accuracy: 0.7437
Class 3 galaxies
  Number of galaxies: 3295 (52 batches)
	test Loss: 0.2485	 test Accuracy: 0.9111
Class 4 galaxies
  Number of galaxies: 4148 (65 batches)
	test Loss: 0.4299	 test Accuracy: 0.8527
Class 5 galaxies
  Number of galaxies: 6094 (96 batches)
	test Loss: 0.5306	 test Accuracy: 0.7950
Class 6 galaxies
  Number of galaxies: 1176 (19 batches)
	test Loss: 1.2007	 test Accuracy: 0.5468
Class 7 galaxies
  Number of galaxies: 407 (7 batches)
	test Loss: 0.9844	 test Accuracy: 0.6855