Namespace(config='experiment/resnet50/configs/run7.yaml')

------ Parameters ------

exp_name : run7
cuda : True
ngpu : 1
gpu_device : 0
workers : 2
dir_image : /home/hhg/Research/galaxyClassify/catalog/galaxyZoo_kaggle/gz2_images//images
file_csv : /home/hhg/Research/galaxyClassify/catalog/galaxyZoo/zoo2/gz2_all_exIrr_v2.csv
label_tag : label_exIrr
num_classes : 7
class_weights : [1.0, 0.86, 4.6, 1.28, 1.66, 1.1, 16.0]
f_train : 0.64
f_valid : 0.16
f_test : 0.2
seed : 3
norm_mean : [0.485, 0.456, 0.406]
norm_std : [0.229, 0.224, 0.225]
input_size : 224
pretrained : True
num_epochs : 50
batch_size : 64
lr : 5e-05
step_size : 5
gamma : 0.1
early_stop_threshold : 10
dir_output : /home/hhg/Research/galaxyClassify/repo/galaxyZooNet/experiment/resnet50

------ Prepare Data ------

Number of train galaxies: 96016 (1501 batches)
Number of valid galaxies: 24004 (376 batches)
Number of test galaxies: 30006 (469 batches)

------ Build Model ------

Number of trainable parameters
layer1 : 215808
layer2 : 1219584
layer3 : 14964736
layer4 : 7098368
fc     : 14343
TOTAL  : 23522375

------ Create experiment directory ------

Training information will be stored at :
 	 /home/hhg/Research/galaxyClassify/repo/galaxyZooNet/experiment/resnet50/run7

------ Training ------

Epoch 1/50
	train Loss: 0.7249 Acc: 0.7220 	valid Loss: 0.5971 Acc: 0.7567 	Time: 9m 37s
Epoch 2/50
	train Loss: 0.5628 Acc: 0.7792 	valid Loss: 0.5395 Acc: 0.7701 	Time: 9m 39s
Epoch 3/50
	train Loss: 0.5286 Acc: 0.7902 	valid Loss: 0.4859 Acc: 0.8211 	Time: 9m 38s
Epoch 4/50
	train Loss: 0.5092 Acc: 0.7972 	valid Loss: 0.4738 Acc: 0.8051 	Time: 9m 38s
Epoch 5/50
	train Loss: 0.4857 Acc: 0.8026 	valid Loss: 0.4439 Acc: 0.8135 	Time: 9m 38s
Epoch 6/50
	train Loss: 0.4224 Acc: 0.8255 	valid Loss: 0.4020 Acc: 0.8385 	Time: 9m 38s
Epoch 7/50
	train Loss: 0.4042 Acc: 0.8312 	valid Loss: 0.3986 Acc: 0.8369 	Time: 9m 38s
Epoch 8/50
	train Loss: 0.3942 Acc: 0.8334 	valid Loss: 0.3891 Acc: 0.8389 	Time: 9m 38s
Epoch 9/50
	train Loss: 0.3892 Acc: 0.8349 	valid Loss: 0.3874 Acc: 0.8383 	Time: 9m 39s
Epoch 10/50
	train Loss: 0.3835 Acc: 0.8378 	valid Loss: 0.3837 Acc: 0.8399 	Time: 9m 39s
Epoch 11/50
	train Loss: 0.3769 Acc: 0.8405 	valid Loss: 0.3813 Acc: 0.8442 	Time: 9m 39s
Epoch 12/50
	train Loss: 0.3729 Acc: 0.8420 	valid Loss: 0.3754 Acc: 0.8442 	Time: 9m 39s
Epoch 13/50
	train Loss: 0.3742 Acc: 0.8410 	valid Loss: 0.3846 Acc: 0.8406 	Time: 9m 39s
Epoch 14/50
	train Loss: 0.3713 Acc: 0.8429 	valid Loss: 0.3804 Acc: 0.8462 	Time: 9m 39s
Epoch 15/50
	train Loss: 0.3711 Acc: 0.8425 	valid Loss: 0.3832 Acc: 0.8413 	Time: 9m 38s
Epoch 16/50
	train Loss: 0.3713 Acc: 0.8417 	valid Loss: 0.3783 Acc: 0.8439 	Time: 9m 39s
Epoch 17/50
	train Loss: 0.3691 Acc: 0.8423 	valid Loss: 0.3819 Acc: 0.8406 	Time: 9m 39s
Epoch 18/50
	train Loss: 0.3708 Acc: 0.8417 	valid Loss: 0.3784 Acc: 0.8452 	Time: 9m 38s
Epoch 19/50
	train Loss: 0.3722 Acc: 0.8411 	valid Loss: 0.3812 Acc: 0.8449 	Time: 9m 39s
Epoch 20/50
	train Loss: 0.3708 Acc: 0.8417 	valid Loss: 0.3780 Acc: 0.8440 	Time: 9m 39s
Epoch 21/50
	train Loss: 0.3712 Acc: 0.8420 	valid Loss: 0.3762 Acc: 0.8433 	Time: 9m 39s
Epoch 22/50
	train Loss: 0.3722 Acc: 0.8418 	valid Loss: 0.3817 Acc: 0.8427 	Time: 9m 39s
Epoch 23/50
	train Loss: 0.3716 Acc: 0.8417 	valid Loss: 0.3786 Acc: 0.8437 	Time: 9m 39s
Epoch 24/50
	train Loss: 0.3725 Acc: 0.8412 	valid Loss: 0.3788 Acc: 0.8424 	Time: 9m 39s
Early stopping... (Model did not imporve after 10 epochs)
Best accuracy of 0.8461506415597401 reached at epoch 14.

------ Run test on the full test dataset (7 galaxy classes) ------

  Number of galaxies: 30006 (469 batches)
	test Loss: 0.3865	 test Accuracy: 0.8454

------ Run test on each galaxy morphology class separately ------

Class 0 galaxies
  Number of galaxies: 6820 (107 batches)
	test Loss: 0.1907	 test Accuracy: 0.9368
Class 1 galaxies
  Number of galaxies: 7856 (123 batches)
	test Loss: 0.4209	 test Accuracy: 0.8320
Class 2 galaxies
  Number of galaxies: 1482 (24 batches)
	test Loss: 0.3586	 test Accuracy: 0.8704
Class 3 galaxies
  Number of galaxies: 3329 (53 batches)
	test Loss: 0.3694	 test Accuracy: 0.8447
Class 4 galaxies
  Number of galaxies: 4028 (63 batches)
	test Loss: 0.4045	 test Accuracy: 0.8607
Class 5 galaxies
  Number of galaxies: 6054 (95 batches)
	test Loss: 0.6591	 test Accuracy: 0.7393
Class 6 galaxies
  Number of galaxies: 437 (7 batches)
	test Loss: 0.2944	 test Accuracy: 0.9085
