Namespace(config='experiment/resnet50/configs/run5.yaml')

------ Parameters ------

exp_name : run5
cuda : True
ngpu : 1
gpu_device : 0
workers : 2
dir_image : /home/u16/hungjinh/Research/galaxyClassifiy/catalog/galaxyZoo/zoo2/images
file_csv : /home/u16/hungjinh/Research/galaxyClassifiy/catalog/galaxyZoo/zoo2/gz2_all_v2.csv
label_tag : label_3
num_classes : 3
f_train : 0.64
f_valid : 0.16
f_test : 0.2
seed : 3
norm_mean : [0.485, 0.456, 0.406]
norm_std : [0.229, 0.224, 0.225]
input_size : 224
pretrained : True
num_epochs : 50
batch_size : 64
lr : 5e-05
step_size : 5
gamma : 0.1
early_stop_threshold : 10
dir_output : /home/u16/hungjinh/Research/galaxyClassifiy/repo/galaxyZooNet/experiment/resnet50

------ Prepare Data ------

Number of train galaxies: 99808 (1560 batches)
Number of valid galaxies: 24952 (390 batches)
Number of test galaxies: 31191 (488 batches)

------ Build Model ------

Number of trainable parameters
layer1 : 215808
layer2 : 1219584
layer3 : 14964736
layer4 : 7098368
fc     : 6147
TOTAL  : 23514179

------ Create experiment directory ------

Training information will be stored at :
 	 /home/u16/hungjinh/Research/galaxyClassifiy/repo/galaxyZooNet/experiment/resnet50/run5

------ Training ------

Epoch 1/50
	train Loss: 0.3751 Acc: 0.8546 	valid Loss: 0.3164 Acc: 0.8775 	Time: 6m 2s
Epoch 2/50
	train Loss: 0.3207 Acc: 0.8746 	valid Loss: 0.2910 Acc: 0.8866 	Time: 5m 60s
Epoch 3/50
	train Loss: 0.3054 Acc: 0.8810 	valid Loss: 0.2927 Acc: 0.8856 	Time: 6m 11s
Epoch 4/50
	train Loss: 0.2966 Acc: 0.8849 	valid Loss: 0.2903 Acc: 0.8855 	Time: 6m 0s
Epoch 5/50
	train Loss: 0.2895 Acc: 0.8873 	valid Loss: 0.2836 Acc: 0.8879 	Time: 6m 3s
Epoch 6/50
	train Loss: 0.2607 Acc: 0.8978 	valid Loss: 0.2592 Acc: 0.8975 	Time: 6m 1s
Epoch 7/50
	train Loss: 0.2540 Acc: 0.9002 	valid Loss: 0.2572 Acc: 0.8987 	Time: 6m 3s
Epoch 8/50
	train Loss: 0.2511 Acc: 0.9005 	valid Loss: 0.2569 Acc: 0.8989 	Time: 6m 1s
Epoch 9/50
	train Loss: 0.2476 Acc: 0.9014 	valid Loss: 0.2536 Acc: 0.8994 	Time: 6m 5s
Epoch 10/50
	train Loss: 0.2462 Acc: 0.9025 	valid Loss: 0.2555 Acc: 0.8989 	Time: 6m 3s
Epoch 11/50
	train Loss: 0.2424 Acc: 0.9036 	valid Loss: 0.2535 Acc: 0.8999 	Time: 6m 3s
Epoch 12/50
	train Loss: 0.2414 Acc: 0.9049 	valid Loss: 0.2523 Acc: 0.9000 	Time: 6m 1s
Epoch 13/50
	train Loss: 0.2399 Acc: 0.9045 	valid Loss: 0.2541 Acc: 0.9015 	Time: 6m 2s
Epoch 14/50
	train Loss: 0.2400 Acc: 0.9046 	valid Loss: 0.2516 Acc: 0.9014 	Time: 6m 3s
Epoch 15/50
	train Loss: 0.2387 Acc: 0.9053 	valid Loss: 0.2528 Acc: 0.8996 	Time: 6m 4s
Epoch 16/50
	train Loss: 0.2391 Acc: 0.9057 	valid Loss: 0.2541 Acc: 0.8995 	Time: 6m 1s
Epoch 17/50
	train Loss: 0.2386 Acc: 0.9050 	valid Loss: 0.2519 Acc: 0.9003 	Time: 6m 7s
Epoch 18/50
	train Loss: 0.2390 Acc: 0.9045 	valid Loss: 0.2538 Acc: 0.9011 	Time: 5m 60s
Epoch 19/50
	train Loss: 0.2387 Acc: 0.9055 	valid Loss: 0.2527 Acc: 0.9010 	Time: 6m 2s
Epoch 20/50
	train Loss: 0.2393 Acc: 0.9048 	valid Loss: 0.2530 Acc: 0.9012 	Time: 6m 1s
Epoch 21/50
	train Loss: 0.2391 Acc: 0.9043 	valid Loss: 0.2549 Acc: 0.9001 	Time: 6m 7s
Epoch 22/50
	train Loss: 0.2388 Acc: 0.9060 	valid Loss: 0.2504 Acc: 0.9006 	Time: 6m 9s
Epoch 23/50
	train Loss: 0.2387 Acc: 0.9045 	valid Loss: 0.2525 Acc: 0.8998 	Time: 6m 3s
Early stopping... (Model did not imporve after 10 epochs)
Best accuracy of 0.901530939403655 reached at epoch 13.

------ Run test on the full test dataset (3 galaxy classes) ------

  Number of galaxies: 31191 (488 batches)
	test Loss: 0.2596	 test Accuracy: 0.8989

------ Run test on each galaxy morphology class separately ------

Class 0 galaxies
  Number of galaxies: 16172 (253 batches)
	test Loss: 0.1653	 test Accuracy: 0.9400
Class 1 galaxies
  Number of galaxies: 13448 (211 batches)
	test Loss: 0.2730	 test Accuracy: 0.8870
Class 2 galaxies
  Number of galaxies: 1571 (25 batches)
	test Loss: 1.1148	 test Accuracy: 0.5773

