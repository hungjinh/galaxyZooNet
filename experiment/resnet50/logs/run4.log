Namespace(config='experiment/resnet50/configs/run4.yaml')

------ Parameters ------

exp_name : run4
cuda : True
ngpu : 1
gpu_device : 0
workers : 2
dir_image : /home/u16/hungjinh/Research/galaxyClassifiy/catalog/galaxyZoo/zoo2/images
file_csv : /home/u16/hungjinh/Research/galaxyClassifiy/catalog/galaxyZoo/zoo2/classAll_4label_temp.csv
label_tag : label1
num_classes : 8
f_train : 0.64
f_valid : 0.16
f_test : 0.2
seed : 3
norm_mean : [0.5, 0.5, 0.5]
norm_std : [0.5, 0.5, 0.5]
input_size : 224
pretrained : True
num_epochs : 99
batch_size : 64
lr : 5e-05
step_size : 5
gamma : 0.1
early_stop_threshold : 15
dir_output : /home/u16/hungjinh/Research/galaxyClassifiy/repo/galaxyZooNet/experiment/resnet50

------ Prepare Data ------

Number of train galaxies: 99808 (1560 batches)
Number of valid galaxies: 24952 (390 batches)
Number of test galaxies: 31191 (488 batches)

------ Build Model ------

Number of trainable parameters
layer1 : 215808
layer2 : 1219584
layer3 : 14964736
layer4 : 7098368
fc     : 16392
TOTAL  : 23524424

------ Create experiment directory ------

Training information will be stored at :
 	 /home/u16/hungjinh/Research/galaxyClassifiy/repo/galaxyZooNet/experiment/resnet50/run4

------ Training ------

Epoch 1/99
	train Loss: 0.6948 Acc: 0.7461 	valid Loss: 0.5770 Acc: 0.7874 	Time: 7m 5s
Epoch 2/99
	train Loss: 0.5594 Acc: 0.7956 	valid Loss: 0.5261 Acc: 0.8057 	Time: 6m 2s
Epoch 3/99
	train Loss: 0.5287 Acc: 0.8056 	valid Loss: 0.5194 Acc: 0.8113 	Time: 6m 8s
Epoch 4/99
	train Loss: 0.5063 Acc: 0.8139 	valid Loss: 0.5282 Acc: 0.8068 	Time: 6m 11s
Epoch 5/99
	train Loss: 0.4915 Acc: 0.8191 	valid Loss: 0.4876 Acc: 0.8198 	Time: 6m 8s
Epoch 6/99
	train Loss: 0.4330 Acc: 0.8400 	valid Loss: 0.4386 Acc: 0.8372 	Time: 6m 7s
Epoch 7/99
	train Loss: 0.4193 Acc: 0.8436 	valid Loss: 0.4365 Acc: 0.8373 	Time: 6m 18s
Epoch 8/99
	train Loss: 0.4143 Acc: 0.8459 	valid Loss: 0.4297 Acc: 0.8421 	Time: 6m 16s
Epoch 9/99
	train Loss: 0.4087 Acc: 0.8479 	valid Loss: 0.4288 Acc: 0.8443 	Time: 6m 14s
Epoch 10/99
	train Loss: 0.4058 Acc: 0.8487 	valid Loss: 0.4240 Acc: 0.8427 	Time: 6m 2s
Epoch 11/99
	train Loss: 0.3990 Acc: 0.8516 	valid Loss: 0.4237 Acc: 0.8431 	Time: 6m 3s
Epoch 12/99
	train Loss: 0.3971 Acc: 0.8526 	valid Loss: 0.4263 Acc: 0.8426 	Time: 6m 10s
Epoch 13/99
	train Loss: 0.3948 Acc: 0.8523 	valid Loss: 0.4245 Acc: 0.8436 	Time: 5m 58s
Epoch 14/99
	train Loss: 0.3938 Acc: 0.8535 	valid Loss: 0.4262 Acc: 0.8456 	Time: 6m 17s
Epoch 15/99
	train Loss: 0.3931 Acc: 0.8539 	valid Loss: 0.4212 Acc: 0.8447 	Time: 6m 8s
Epoch 16/99
	train Loss: 0.3918 Acc: 0.8535 	valid Loss: 0.4225 Acc: 0.8447 	Time: 6m 8s
Epoch 17/99
	train Loss: 0.3919 Acc: 0.8542 	valid Loss: 0.4226 Acc: 0.8440 	Time: 6m 8s
Epoch 18/99
	train Loss: 0.3935 Acc: 0.8540 	valid Loss: 0.4223 Acc: 0.8446 	Time: 6m 13s
Epoch 19/99
	train Loss: 0.3935 Acc: 0.8530 	valid Loss: 0.4235 Acc: 0.8430 	Time: 6m 9s
Epoch 20/99
	train Loss: 0.3919 Acc: 0.8542 	valid Loss: 0.4236 Acc: 0.8437 	Time: 6m 10s
Epoch 21/99
	train Loss: 0.3916 Acc: 0.8541 	valid Loss: 0.4201 Acc: 0.8453 	Time: 6m 6s
Epoch 22/99
	train Loss: 0.3925 Acc: 0.8530 	valid Loss: 0.4253 Acc: 0.8431 	Time: 6m 4s
Epoch 23/99
	train Loss: 0.3915 Acc: 0.8543 	valid Loss: 0.4240 Acc: 0.8435 	Time: 6m 6s
Epoch 24/99
	train Loss: 0.3929 Acc: 0.8540 	valid Loss: 0.4219 Acc: 0.8444 	Time: 6m 3s
Epoch 25/99
	train Loss: 0.3929 Acc: 0.8536 	valid Loss: 0.4215 Acc: 0.8465 	Time: 6m 7s
Epoch 26/99
	train Loss: 0.3923 Acc: 0.8544 	valid Loss: 0.4238 Acc: 0.8445 	Time: 6m 4s
Epoch 27/99
	train Loss: 0.3930 Acc: 0.8529 	valid Loss: 0.4235 Acc: 0.8434 	Time: 6m 6s
Epoch 28/99
	train Loss: 0.3919 Acc: 0.8538 	valid Loss: 0.4199 Acc: 0.8438 	Time: 6m 12s
Epoch 29/99
	train Loss: 0.3923 Acc: 0.8532 	valid Loss: 0.4254 Acc: 0.8436 	Time: 6m 5s
Epoch 30/99
	train Loss: 0.3922 Acc: 0.8530 	valid Loss: 0.4214 Acc: 0.8439 	Time: 6m 10s
Epoch 31/99
	train Loss: 0.3921 Acc: 0.8531 	valid Loss: 0.4198 Acc: 0.8470 	Time: 6m 15s
Epoch 32/99
	train Loss: 0.3942 Acc: 0.8524 	valid Loss: 0.4204 Acc: 0.8466 	Time: 6m 12s
Epoch 33/99
	train Loss: 0.3923 Acc: 0.8538 	valid Loss: 0.4272 Acc: 0.8431 	Time: 6m 6s
Epoch 34/99
	train Loss: 0.3910 Acc: 0.8546 	valid Loss: 0.4220 Acc: 0.8434 	Time: 6m 8s
Epoch 35/99
	train Loss: 0.3933 Acc: 0.8534 	valid Loss: 0.4237 Acc: 0.8447 	Time: 6m 14s
Epoch 36/99
	train Loss: 0.3923 Acc: 0.8533 	valid Loss: 0.4236 Acc: 0.8435 	Time: 6m 15s
Epoch 37/99
	train Loss: 0.3936 Acc: 0.8528 	valid Loss: 0.4215 Acc: 0.8463 	Time: 6m 13s
Epoch 38/99
	train Loss: 0.3936 Acc: 0.8533 	valid Loss: 0.4205 Acc: 0.8463 	Time: 6m 8s
Epoch 39/99
	train Loss: 0.3953 Acc: 0.8520 	valid Loss: 0.4230 Acc: 0.8456 	Time: 6m 8s
Epoch 40/99
	train Loss: 0.3923 Acc: 0.8534 	valid Loss: 0.4210 Acc: 0.8448 	Time: 6m 12s
Epoch 41/99
	train Loss: 0.3912 Acc: 0.8542 	valid Loss: 0.4223 Acc: 0.8448 	Time: 6m 11s
Epoch 42/99
	train Loss: 0.3935 Acc: 0.8528 	valid Loss: 0.4214 Acc: 0.8458 	Time: 6m 2s
Epoch 43/99
	train Loss: 0.3921 Acc: 0.8533 	valid Loss: 0.4221 Acc: 0.8442 	Time: 6m 10s
Epoch 44/99
	train Loss: 0.3935 Acc: 0.8537 	valid Loss: 0.4219 Acc: 0.8438 	Time: 6m 9s
Epoch 45/99
	train Loss: 0.3945 Acc: 0.8536 	valid Loss: 0.4244 Acc: 0.8461 	Time: 6m 9s
Epoch 46/99
	train Loss: 0.3921 Acc: 0.8547 	valid Loss: 0.4239 Acc: 0.8430 	Time: 6m 7s
Early stopping... (Model did not imporve after 15 epochs)
Best accuracy of 0.8469862135299776 reached at epoch 31.

------ Run test on the full test dataset (8 galaxy classes) ------

  Number of galaxies: 31191 (488 batches)
	test Loss: 0.4168	 test Accuracy: 0.8471

------ Run test on each galaxy morphology class separately ------

Class 0 galaxies
  Number of galaxies: 6755 (106 batches)
	test Loss: 0.2191	 test Accuracy: 0.9309
Class 1 galaxies
  Number of galaxies: 7845 (123 batches)
	test Loss: 0.3340	 test Accuracy: 0.8711
Class 2 galaxies
  Number of galaxies: 1471 (23 batches)
	test Loss: 0.6703	 test Accuracy: 0.7356
Class 3 galaxies
  Number of galaxies: 3295 (52 batches)
	test Loss: 0.2803	 test Accuracy: 0.9056
Class 4 galaxies
  Number of galaxies: 4148 (65 batches)
	test Loss: 0.4784	 test Accuracy: 0.8320
Class 5 galaxies
  Number of galaxies: 6094 (96 batches)
	test Loss: 0.5107	 test Accuracy: 0.8000
Class 6 galaxies
  Number of galaxies: 1176 (19 batches)
	test Loss: 1.2680	 test Accuracy: 0.5383
Class 7 galaxies
  Number of galaxies: 407 (7 batches)
	test Loss: 0.9947	 test Accuracy: 0.6732

