Namespace(config='experiment/resnet50/configs/run3.yaml')

------ Parameters ------

exp_name : run3
cuda : True
ngpu : 1
gpu_device : 0
workers : 2
dir_image : /home/u16/hungjinh/Research/galaxyClassifiy/catalog/galaxyZoo/zoo2/images
file_csv : /home/u16/hungjinh/Research/galaxyClassifiy/catalog/galaxyZoo/zoo2/gz2_all_v2.csv
label_tag : label_7
num_classes : 7
f_train : 0.64
f_valid : 0.16
f_test : 0.2
seed : 3
norm_mean : [0.485, 0.456, 0.406]
norm_std : [0.229, 0.224, 0.225]
input_size : 224
pretrained : True
num_epochs : 50
batch_size : 64
lr : 5e-05
step_size : 5
gamma : 0.1
early_stop_threshold : 10
dir_output : /home/u16/hungjinh/Research/galaxyClassifiy/repo/galaxyZooNet/experiment/resnet50

------ Prepare Data ------

Number of train galaxies: 99808 (1560 batches)
Number of valid galaxies: 24952 (390 batches)
Number of test galaxies: 31191 (488 batches)

------ Build Model ------

Number of trainable parameters
layer1 : 215808
layer2 : 1219584
layer3 : 14964736
layer4 : 7098368
fc     : 14343
TOTAL  : 23522375

------ Create experiment directory ------

Training information will be stored at :
 	 /home/u16/hungjinh/Research/galaxyClassifiy/repo/galaxyZooNet/experiment/resnet50/run3

------ Training ------

Epoch 1/50
	train Loss: 0.6752 Acc: 0.7476 	valid Loss: 0.5837 Acc: 0.7827 	Time: 6m 8s
Epoch 2/50
	train Loss: 0.5471 Acc: 0.7959 	valid Loss: 0.5105 Acc: 0.8108 	Time: 6m 4s
Epoch 3/50
	train Loss: 0.5138 Acc: 0.8089 	valid Loss: 0.5049 Acc: 0.8088 	Time: 6m 3s
Epoch 4/50
	train Loss: 0.4958 Acc: 0.8152 	valid Loss: 0.4717 Acc: 0.8227 	Time: 6m 6s
Epoch 5/50
	train Loss: 0.4797 Acc: 0.8210 	valid Loss: 0.4804 Acc: 0.8210 	Time: 6m 4s
Epoch 6/50
	train Loss: 0.4251 Acc: 0.8403 	valid Loss: 0.4204 Acc: 0.8427 	Time: 6m 13s
Epoch 7/50
	train Loss: 0.4126 Acc: 0.8444 	valid Loss: 0.4139 Acc: 0.8432 	Time: 6m 4s
Epoch 8/50
	train Loss: 0.4063 Acc: 0.8477 	valid Loss: 0.4103 Acc: 0.8465 	Time: 6m 4s
Epoch 9/50
	train Loss: 0.4017 Acc: 0.8486 	valid Loss: 0.4120 Acc: 0.8453 	Time: 6m 6s
Epoch 10/50
	train Loss: 0.3976 Acc: 0.8496 	valid Loss: 0.4086 Acc: 0.8450 	Time: 6m 2s
Epoch 11/50
	train Loss: 0.3880 Acc: 0.8536 	valid Loss: 0.4034 Acc: 0.8484 	Time: 6m 7s
Epoch 12/50
	train Loss: 0.3875 Acc: 0.8539 	valid Loss: 0.4049 Acc: 0.8494 	Time: 6m 6s
Epoch 13/50
	train Loss: 0.3893 Acc: 0.8543 	valid Loss: 0.4061 Acc: 0.8482 	Time: 6m 4s
Epoch 14/50
	train Loss: 0.3870 Acc: 0.8545 	valid Loss: 0.4068 Acc: 0.8485 	Time: 6m 5s
Epoch 15/50
	train Loss: 0.3875 Acc: 0.8531 	valid Loss: 0.4033 Acc: 0.8496 	Time: 6m 5s
Epoch 16/50
	train Loss: 0.3852 Acc: 0.8549 	valid Loss: 0.4050 Acc: 0.8482 	Time: 6m 2s
Epoch 17/50
	train Loss: 0.3860 Acc: 0.8554 	valid Loss: 0.4047 Acc: 0.8485 	Time: 6m 9s
Epoch 18/50
	train Loss: 0.3861 Acc: 0.8544 	valid Loss: 0.4059 Acc: 0.8486 	Time: 6m 6s
Epoch 19/50
	train Loss: 0.3840 Acc: 0.8557 	valid Loss: 0.4017 Acc: 0.8481 	Time: 6m 6s
Epoch 20/50
	train Loss: 0.3855 Acc: 0.8551 	valid Loss: 0.4035 Acc: 0.8490 	Time: 6m 4s
Epoch 21/50
	train Loss: 0.3849 Acc: 0.8554 	valid Loss: 0.4039 Acc: 0.8485 	Time: 6m 6s
Epoch 22/50
	train Loss: 0.3855 Acc: 0.8539 	valid Loss: 0.4049 Acc: 0.8489 	Time: 6m 11s
Epoch 23/50
	train Loss: 0.3855 Acc: 0.8551 	valid Loss: 0.4073 Acc: 0.8471 	Time: 6m 4s
Epoch 24/50
	train Loss: 0.3862 Acc: 0.8548 	valid Loss: 0.4036 Acc: 0.8480 	Time: 6m 11s
Epoch 25/50
	train Loss: 0.3852 Acc: 0.8546 	valid Loss: 0.4044 Acc: 0.8467 	Time: 6m 7s
Early stopping... (Model did not imporve after 10 epochs)
Best accuracy of 0.8495912151330555 reached at epoch 15.

------ Run test on the full test dataset (7 galaxy classes) ------

  Number of galaxies: 31191 (488 batches)
	test Loss: 0.4140	 test Accuracy: 0.8439

------ Run test on each galaxy morphology class separately ------

Class 0 galaxies
  Number of galaxies: 6772 (106 batches)
	test Loss: 0.2254	 test Accuracy: 0.9250
Class 1 galaxies
  Number of galaxies: 7900 (124 batches)
	test Loss: 0.3793	 test Accuracy: 0.8532
Class 2 galaxies
  Number of galaxies: 1500 (24 batches)
	test Loss: 0.7443	 test Accuracy: 0.6987
Class 3 galaxies
  Number of galaxies: 3195 (50 batches)
	test Loss: 0.2223	 test Accuracy: 0.9224
Class 4 galaxies
  Number of galaxies: 4054 (64 batches)
	test Loss: 0.4159	 test Accuracy: 0.8552
Class 5 galaxies
  Number of galaxies: 6199 (97 batches)
	test Loss: 0.5136	 test Accuracy: 0.7937
Class 6 galaxies
  Number of galaxies: 1571 (25 batches)
	test Loss: 1.0784	 test Accuracy: 0.5958

